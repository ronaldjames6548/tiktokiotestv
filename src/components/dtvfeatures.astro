---
import Link from "@components/ui/link.astro";
// Add new built-in i18n imports
import { getLangFromUrl, useTranslations } from "../i18n/utils";
import { getRelativeLocaleUrl } from "astro:i18n";

// @ts-ignore
import { Icon } from "astro-icon/components";

// Get current language and create translation function
const safeUrl = Astro.url || new URL('/', Astro.site || 'http://localhost:4321');
const lang = getLangFromUrl(safeUrl);
const t = useTranslations(lang);

// Helper function to create localized paths (if needed)
function localizePath(path: string) {
	if (!path || (path && path.startsWith('http')) || path === '#') return path;
	return getRelativeLocaleUrl(lang, path);
}

// Simply paste your SVG code as a string in the icon property
const features = [
	{
		icon: `<svg fill="#ffffff" width="32px" height="32px" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg"><path d="M248,128a55.99955,55.99955,0,0,1-95.59766,39.59766q-.17137-.17139-.332-.35254L92.11963,99.55225a40,40,0,1,0,0,56.8955l8.519-9.61914a8,8,0,1,1,11.97754,10.6084l-8.68652,9.80811q-.16041.1809-.332.35254a56,56,0,1,1,0-79.19532q.17137.17139.332.35254l59.95068,67.69287a40,40,0,1,0,0-56.8955l-8.519,9.61914A8,8,0,0,1,143.38379,98.563l8.68652-9.80811q.16041-.1809.332-.35254A56,56,0,0,1,248,128Z"></path></svg>`,
		iconBg: "bg-blue-500",
		title: "Boundless Downloads",
		description: "Fetch as many TikTok videos as your heart desires without limitations."
	},
	{
		icon: `<svg fill="#ffffff" width="32px" height="32px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z"/></svg>`,
		iconBg: "bg-orange-500",
		title: "Rapid and Straightforward",
		description: "Experience blazing-fast downloads, even on slower internet connections."
	},
	{
		icon: `<svg fill="#ffffff" width="32px" height="32px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8 0-1.85.63-3.55 1.69-4.9l10.9 10.9C15.55 19.37 13.85 20 12 20zm6.31-3.1L7.1 5.69C8.45 4.63 10.15 4 12 4c4.41 0 8 3.59 8 8 0 1.85-.63 3.55-1.69 4.9z"/></svg>`,
		iconBg: "bg-green-500",
		title: "Completely Watermark-Free",
		description: "Every video downloaded comes pure — no watermarks, just clarity."
	},
	{
		icon: `<svg fill="#ffffff" width="32px" height="32px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"/></svg>`,
		iconBg: "bg-pink-500",
		title: "Secure and Private",
		description: "No logins required — your data remains secure with DownloadTik."
	},
	{
		icon: `<svg fill="#ffffff" width="32px" height="32px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2h-4zM4 6h16v10H4V6z"/></svg>`,
		iconBg: "bg-purple-600",
		title: "Feature-Rich Tools",
		description: "Track views and store videos — features unavailable within the TikTok app."
	},
	{
		icon: `<svg fill="#ffffff" width="32px" height="32px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/></svg>`,
		iconBg: "bg-yellow-500",
		title: "No Installation Required",
		description: "No accounts, no software, no problem — just paste and download."
	}
];
---

<div class="relative p-4">
	<div class="max-w-screen-xl mx-auto">
		<div class="rounded-b lg:rounded-b-none lg:rounded-r flex flex-col justify-between leading-normal">

			<!-- New Features Section -->
			<section class="py-16 bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900 rounded-xl mb-12">
				<div class="max-w-6xl mx-auto px-6">
					<!-- Header Section -->
					<div class="text-center mb-16">
						<h2 class="text-4xl md:text-5xl font-bold text-white mb-6">
							Why Choose DownloadTik for TikTok Story Downloads?
						</h2>
						<p class="text-gray-300 text-lg max-w-3xl mx-auto">
							Quickly capture any TikTok story you admire — effortlessly by using DownloadTik.
							<br />
							No watermarks, no caps, just seamless downloads.
						</p>
					</div>

					<!-- Features Grid -->
					<div class="grid md:grid-cols-2 gap-8">
						{features.map((feature) => (
							<div class="flex gap-4">
								<!-- Icon -->
								<div class={`${feature.iconBg} rounded-2xl w-14 h-14 flex items-center justify-center flex-shrink-0`}>
									<Fragment set:html={feature.icon} />
								</div>
								
								<!-- Content -->
								<div>
									<h3 class="text-xl font-bold text-white mb-2">
										{feature.title}
									</h3>
									<p class="text-gray-300 leading-relaxed">
										{feature.description}
									</p>
								</div>
							</div>
						))}
					</div>
				</div>
			</section>

			<!-- How It Works Simple Section -->
			<section class="text-center mb-12">
				<h3 class="md:text-2xl text-[18px] font-bold mb-4">How It Works</h3>
				<ol class="space-y-4 text-left max-w-xl mx-auto">
					<li class="flex items-start gap-3">
						<span class="bg-purple-500 rounded-full w-6 h-6 flex items-center justify-center text-xs flex-shrink-0 mt-1">1</span>
						<span class="md:text-[16px] text-[14px]">Paste the TikTok video link into the input box above.</span>
					</li>
					<li class="flex items-start gap-3">
						<span class="bg-purple-500 rounded-full w-6 h-6 flex items-center justify-center text-xs flex-shrink-0 mt-1">2</span>
						<span class="md:text-[16px] text-[14px]">Click on the 'Download' button to fetch the video data.</span>
					</li>
					<li class="flex items-start gap-3">
						<span class="bg-purple-500 rounded-full w-6 h-6 flex items-center justify-center text-xs flex-shrink-0 mt-1">3</span>
						<span class="md:text-[16px] text-[14px]">Select whether you want to download the video, audio, or cover image.</span>
					</li>
				</ol>
			</section>

			<!-- How to Play Section -->
			<section id="how-to-play" class="py-20 relative overflow-hidden">
				<div class="absolute inset-0 w-full h-full">
					<div class="absolute inset-0"></div>
				</div>

				<div itemprop="itemListElement" itemscope itemtype="https://schema.org/HowToStep" class="container max-w-6xl mx-auto px-4 relative z-10">
					<div class="text-center mb-16">
						<h2 class="text-2xl md:text-3xl font-bold text-gray-900 dark:text-white">
							{t("features.howto")} <span class="text-orange-400 dark:text-orange-400">{t("features.downloadtiktokvideos")}</span> {t("features.easily")}
						</h2>
						<meta itemprop="url" content="/" />
						<meta itemprop="timeRequired" content="PT1M"/>
						<div class="w-24 h-1 mx-auto bg-orange-400 rounded-full"></div>
						<p class="text-gray-900 text-lg mt-6 dark:text-white">{t("features.para2")}</p>
						<p class="text-gray-900 text-lg mt-6 dark:text-white">{t("features.steps")}</p>
					</div>

					<div class="grid grid-cols-1 md:grid-cols-3 gap-8">
						<!--1-->
						<div itemtype="https://schema.org/HowToStep" class="how-to-card bg-gradient-to-r from-slate-900 to-slate-700 rounded-xl backdrop-blur-sm border border-white/10 hover:border-white/20 transition-all duration-300 transform hover:scale-105 hover:-translate-y-2 overflow-hidden">
							<div class="relative h-48 w-full overflow-hidden bg-gradient-to-br from-purple-600/30 to-pink-600/30">
								<img src="/images/tiktok-search.webp" alt="Step 1: Copy the URL" class="w-full h-full object-contain p-4">
								<div class="absolute top-3 left-3 w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center">
									<span itemprop="position" content="1" class="text-xl font-bold text-white">1</span>
								</div>
							</div>

							<div class="p-6">
								<div class="flex items-center gap-3 mb-3">
									<span class="iconify i-mdi:content-copy w-6 h-6 text-pink-400" aria-hidden="true" style=""></span>
									<h3 itemprop="name" class="text-xl font-semibold text-white">{t("features.step1h")}</h3>
								</div>
								<p itemprop="text" class="text-white">{t("features.step1")}</p>
							</div>
						</div>

						<!--2-->
						<div itemtype="https://schema.org/HowToStep" class="how-to-card bg-gradient-to-r from-slate-900 to-slate-700 rounded-xl backdrop-blur-sm border border-white/10 hover:border-white/20 transition-all duration-300 transform hover:scale-105 hover:-translate-y-2 overflow-hidden">
							<div class="relative h-48 w-full overflow-hidden bg-gradient-to-br from-purple-600/30 to-pink-600/30">
								<img src="/images/how-to-step2.webp" alt="Step 2: Paste the link" class="w-full h-full object-contain p-4">
								<div class="absolute top-3 left-3 w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center">
									<span itemprop="position" content="2" class="text-xl font-bold text-white">2</span>
								</div>
							</div>

							<div class="p-6">
								<div class="flex items-center gap-3 mb-3">
									<span class="iconify i-mdi:link w-6 h-6 text-pink-400" aria-hidden="true" style=""></span>
									<h3 itemprop="name" class="text-xl font-semibold text-white">{t("features.step2h")}</h3>
								</div>
								<p itemprop="text" class="text-white">{t("features.step2")}</p>
							</div>
						</div>

						<!--3-->
						<div itemtype="https://schema.org/HowToStep" class="how-to-card bg-gradient-to-r from-slate-900 to-slate-700 rounded-xl backdrop-blur-sm border border-white/10 hover:border-white/20 transition-all duration-300 transform hover:scale-105 hover:-translate-y-2 overflow-hidden">
							<div class="relative h-48 w-full overflow-hidden bg-gradient-to-br from-purple-600/30 to-pink-600/30">
								<img src="/images/how-to-step3.webp" alt="Step 3: Download video" class="w-full h-full object-contain p-4">
								<div class="absolute top-3 left-3 w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center">
									<span itemprop="position" content="3" class="text-xl font-bold text-white">3</span>
								</div>
							</div>
							<div class="p-6">
								<div class="flex items-center gap-3 mb-3">
									<span class="iconify i-mdi:download w-6 h-6 text-pink-400" aria-hidden="true" style=""></span>
									<h3 itemprop="name" class="text-xl font-semibold text-white">{t("features.step3h")}</h3>
								</div>
								<p itemprop="text" class="text-white">{t("features.step3")}</p>
							</div>
						</div>
						<!--End-->
					</div>

					<div class="flex justify-center mt-12">
						<a href="/" class="bg-gradient-to-r from-slate-900 to-slate-700 p-6 rounded-xl backdrop-blur-sm border border-white/10 hover:border-white/20 transition-all duration-300 transform hover:scale-105 hover:-translate-y-2 text-lg text-white dark:text-white">
							{t("features.startdownload")}
						</a>
					</div>
				</div>
			</section>
		</div>
	</div>
</div>
